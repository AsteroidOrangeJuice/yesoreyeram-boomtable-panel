System.register(["lodash", "app/core/utils/kbn", "app/core/time_series2", "./utils"], function (exports_1, context_1) {
    "use strict";
    var lodash_1, kbn_1, time_series2_1, utils, ___transformValue, ___computeColorFromThresholds, ___getServerTimestamp, defaultHandler, getPattern, getRowName, getColName, getThresholds, assignValue, filterValues, getFilteredSeries, getDisplayValueOverride, getBgColor, getOverridedBGColor, getTextColor, getOverridedTextColor, applyFontAwesomeIcons, applyImageTransform, assignClickableLinks, compute;
    var __moduleName = context_1 && context_1.id;
    return {
        setters: [
            function (lodash_1_1) {
                lodash_1 = lodash_1_1;
            },
            function (kbn_1_1) {
                kbn_1 = kbn_1_1;
            },
            function (time_series2_1_1) {
                time_series2_1 = time_series2_1_1;
            },
            function (utils_1) {
                utils = utils_1;
            }
        ],
        execute: function () {
            ___transformValue = function (thresholds, transform_values, value, displayValue, row_name, col_name) {
                var t = value;
                if (thresholds && transform_values && typeof value === "number" && thresholds.length + 1 <= transform_values.length) {
                    transform_values = lodash_1.default.dropRight(transform_values, transform_values.length - thresholds.length - 1);
                    if (transform_values[transform_values.length - 1] === "") {
                        transform_values[transform_values.length - 1] = "_value_";
                    }
                    for (var i = thresholds.length; i > 0; i--) {
                        if (value >= thresholds[i - 1]) {
                            var o_1 = transform_values[i];
                            o_1 = o_1.replace(new RegExp("_value_", "g"), String(displayValue));
                            o_1 = o_1.replace(new RegExp("_row_name_", "g"), String(row_name));
                            o_1 = o_1.replace(new RegExp("_col_name_", "g"), String(col_name));
                            return o_1;
                        }
                    }
                    var o = lodash_1.default.first(transform_values) || "";
                    o = o.replace(new RegExp("_value_", "g"), String(displayValue));
                    o = o.replace(new RegExp("_row_name_", "g"), String(row_name));
                    o = o.replace(new RegExp("_col_name_", "g"), String(col_name));
                    return o;
                }
                return String(t);
            };
            ___computeColorFromThresholds = function (thresholds, bgColors, value, defaultColor) {
                var c = defaultColor;
                if (thresholds && bgColors && typeof value === "number" && thresholds.length + 1 <= bgColors.length) {
                    bgColors = lodash_1.default.dropRight(bgColors, bgColors.length - thresholds.length - 1);
                    if (bgColors[bgColors.length - 1] === "") {
                        bgColors[bgColors.length - 1] = defaultColor;
                    }
                    for (var i = thresholds.length; i > 0; i--) {
                        if (value >= thresholds[i - 1]) {
                            return utils.normalizeColor(bgColors[i]);
                        }
                    }
                    return utils.normalizeColor(lodash_1.default.first(bgColors));
                }
                return c;
            };
            ___getServerTimestamp = function (series) {
                var current_servertimestamp = new Date();
                if (series && series.datapoints && series.datapoints.length > 0) {
                    if (lodash_1.default.last(series.datapoints).length === 2) {
                        current_servertimestamp = new Date(lodash_1.default.last(series.datapoints)[1]);
                    }
                }
                return current_servertimestamp;
            };
            defaultHandler = function (seriesData) {
                var series = new time_series2_1.default({
                    datapoints: seriesData.datapoints || [],
                    alias: seriesData.target
                });
                series.flotpairs = series.getFlotPairs("connected");
                return series;
            };
            exports_1("defaultHandler", defaultHandler);
            getPattern = function (patterns, defaultPattern, alias) {
                var activePatterns = patterns.filter(function (p) { return p.disabled !== true; });
                var matchingPattern = lodash_1.default.find(activePatterns, function (p) {
                    return alias.match(p.pattern);
                });
                return matchingPattern || defaultPattern;
            };
            getRowName = function (alias, pattern, defaultPattern, row_col_wrapper) {
                var row_name = alias.split(String(pattern.delimiter) || ".").reduce(function (r, it, i) {
                    return r.replace(new RegExp(String(row_col_wrapper) + i + String(row_col_wrapper), "g"), it);
                }, pattern.row_name.replace(new RegExp(row_col_wrapper + "series" + row_col_wrapper, "g"), String(alias)) || defaultPattern.row_name.replace(new RegExp(row_col_wrapper + "series" + row_col_wrapper, "g"), String(alias)));
                if (alias.split(String(pattern.delimiter) || ".").length === 1) {
                    row_name = String(alias);
                }
                return row_name;
            };
            getColName = function (alias, row_name, pattern, defaultPattern, row_col_wrapper) {
                var col_name = alias.split(String(pattern.delimiter) || ".").reduce(function (r, it, i) {
                    return r.replace(new RegExp(String(row_col_wrapper) + i + String(row_col_wrapper), "g"), it);
                }, pattern.col_name || defaultPattern.col_name);
                if (alias.split(String(pattern.delimiter) || ".").length === 1 || row_name === alias) {
                    col_name = pattern.col_name || "Value";
                }
                return col_name;
            };
            getThresholds = function (pattern, defaultPattern, current_servertimestamp) {
                var thresholds = (pattern.thresholds || defaultPattern.thresholds).split(",").map(function (d) { return +d; });
                if (pattern.enable_time_based_thresholds) {
                    var metricrecivedTimeStamp_1 = current_servertimestamp || new Date();
                    var metricrecivedTimeStamp_innumber_1 = metricrecivedTimeStamp_1.getHours() * 100 + metricrecivedTimeStamp_1.getMinutes();
                    var weekdays_1 = ["sun", "mon", "tue", "wed", "thu", "fri", "sat"];
                    lodash_1.default.each(pattern.time_based_thresholds, function (tbtx) {
                        if (tbtx && tbtx.from && tbtx.to && tbtx.enabledDays &&
                            (metricrecivedTimeStamp_innumber_1 >= +(tbtx.from)) &&
                            (metricrecivedTimeStamp_innumber_1 <= +(tbtx.to)) &&
                            (tbtx.enabledDays.toLowerCase().indexOf(weekdays_1[metricrecivedTimeStamp_1.getDay()]) > -1) &&
                            tbtx.threshold) {
                            thresholds = (tbtx.threshold + "").split(",").map(function (d) { return +d; });
                        }
                    });
                }
                return thresholds;
            };
            assignValue = function (series, defaultPattern) {
                if (series.stats) {
                    series.value = series.stats[String(series.pattern.valueName) || String(defaultPattern.valueName)];
                    var decimalInfo = utils.getDecimalsForValue(series.value, +(series.decimals));
                    var formatFunc = kbn_1.default.valueFormats[String(series.pattern.format) || String(defaultPattern.format)];
                    if (series.value === null) {
                        series.displayValue = series.pattern.null_value || defaultPattern.null_value || "Null";
                    }
                    else if (!isNaN(series.value)) {
                        series.valueFormatted = formatFunc(series.value, decimalInfo.decimals, decimalInfo.scaledDecimals);
                        series.valueRounded = kbn_1.default.roundValue(series.value, decimalInfo.decimals);
                        series.displayValue = series.valueFormatted;
                    }
                    else {
                        series.displayValue = series.pattern.null_value || defaultPattern.null_value || "Null";
                    }
                }
                return series;
            };
            filterValues = function (series) {
                if (!series.pattern.filter) {
                    series.pattern.filter = {
                        value_below: "",
                        value_above: ""
                    };
                }
                if (series.pattern && series.pattern.filter && (series.pattern.filter.value_below !== "" || series.pattern.filter.value_above !== "")) {
                    if (series.pattern.filter.value_below !== "" && series.value < +(series.pattern.filter.value_below)) {
                        return false;
                    }
                    if (series.pattern.filter.value_above !== "" && series.value > +(series.pattern.filter.value_above)) {
                        return false;
                    }
                    return true;
                }
                else {
                    return true;
                }
            };
            getFilteredSeries = function (seriesArray) {
                var newSeries = [];
                lodash_1.default.each(seriesArray, function (series) {
                    if (filterValues(series)) {
                        newSeries.push(series);
                    }
                });
                return newSeries;
            };
            getDisplayValueOverride = function (transform_values_overrides, value, row_name, col_name, displayValue) {
                var _transform_values_overrides = transform_values_overrides.split("|").filter(function (con) { return con.indexOf("->") > -1; }).map(function (con) { return con.split("->"); }).filter(function (con) { return +(con[0]) === value; }).map(function (con) { return con[1]; });
                if (_transform_values_overrides.length > 0 && _transform_values_overrides[0] !== "") {
                    displayValue = ("" + _transform_values_overrides[0]).trim().replace(new RegExp("_value_", "g"), String(displayValue)).replace(new RegExp("_row_name_", "g"), String(row_name)).replace(new RegExp("_col_name_", "g"), String(col_name));
                }
                return displayValue;
            };
            getBgColor = function (pattern, defaultPattern, enable_bgColor, thresholds, bgColors, value, displayValue) {
                var bgColor = enable_bgColor === true ? ___computeColorFromThresholds(thresholds, bgColors, value, "transparent") : "transparent";
                if (displayValue === (pattern.null_value || defaultPattern.null_value || "Null")) {
                    bgColor = pattern.null_color || defaultPattern.null_color || "transparent";
                }
                return bgColor;
            };
            getOverridedBGColor = function (bgColors_overrides, value, defaultBGColor) {
                var bgColor = defaultBGColor;
                var _bgColors_overrides = bgColors_overrides.split("|").filter(function (con) { return con.indexOf("->") > -1; }).map(function (con) { return con.split("->"); }).filter(function (con) { return +(con[0]) === value; }).map(function (con) { return con[1]; });
                if (_bgColors_overrides.length > 0 && _bgColors_overrides[0] !== "") {
                    bgColor = utils.normalizeColor(("" + _bgColors_overrides[0]).trim());
                }
                return bgColor;
            };
            getTextColor = function (pattern, defaultPattern, enable_TextColors, thresholds, textColors, value, displayValue) {
                var textColor = enable_TextColors === true ? ___computeColorFromThresholds(thresholds, textColors, value, "white") : "white";
                if (displayValue === (pattern.null_value || defaultPattern.null_value || "Null")) {
                    textColor = pattern.null_text_color || defaultPattern.null_text_color || "white";
                }
                return textColor;
            };
            getOverridedTextColor = function (textColors_overrides, value, defaulttextColor) {
                var textColor = defaulttextColor;
                var _textColors_overrides = textColors_overrides.split("|").filter(function (con) { return con.indexOf("->") > -1; }).map(function (con) { return con.split("->"); }).filter(function (con) { return +(con[0]) === value; }).map(function (con) { return con[1]; });
                if (_textColors_overrides.length > 0 && _textColors_overrides[0] !== "") {
                    textColor = utils.normalizeColor(("" + _textColors_overrides[0]).trim());
                }
                return textColor;
            };
            applyFontAwesomeIcons = function (series) {
                series.actual_displayvalue = series.displayValue;
                series.actual_row_name = series.row_name;
                series.actual_col_name = series.col_name;
                if (series.displayValue && series.displayValue.indexOf("_fa-") > -1) {
                    series.displayValue = utils.replaceFontAwesomeIcons(series.displayValue);
                }
                if (series.row_name && series.row_name.indexOf("_fa-") > -1) {
                    series.row_name = utils.replaceFontAwesomeIcons(series.row_name);
                }
                if (series.col_name && series.col_name.indexOf("_fa-") > -1) {
                    series.col_name = utils.replaceFontAwesomeIcons(series.col_name);
                }
                return series;
            };
            applyImageTransform = function (series) {
                if (series.displayValue && series.displayValue.indexOf("_img-") > -1) {
                    series.displayValue = utils.replaceWithImages(series.displayValue);
                }
                if (series.row_name && series.row_name.indexOf("_img-") > -1) {
                    series.row_name = utils.replaceWithImages(series.row_name);
                }
                if (series.col_name && series.col_name.indexOf("_img-") > -1) {
                    series.col_name = utils.replaceWithImages(series.col_name);
                }
                return series;
            };
            assignClickableLinks = function (series) {
                if (series.pattern.enable_clickable_cells) {
                    var targetLink = series.pattern.clickable_cells_link || "#";
                    targetLink = targetLink.replace(new RegExp("_row_name_", "g"), utils.getActualNameWithoutTransformSign(series.actual_row_name).trim());
                    targetLink = targetLink.replace(new RegExp("_col_name_", "g"), utils.getActualNameWithoutTransformSign(series.actual_col_name).trim());
                    targetLink = targetLink.replace(new RegExp("_value_", "g"), utils.getActualNameWithoutTransformSign(series.value).trim());
                    series.displayValue = "<a href=\"" + targetLink + "\" target=\"_blank\">" + series.displayValue + "</a>";
                }
                return series;
            };
            compute = function (dataComputed, defaultPattern, patterns, row_col_wrapper) {
                dataComputed = dataComputed.map(function (series) {
                    series.pattern = getPattern(patterns, defaultPattern, series.alias);
                    series.decimals = series.pattern.decimals || defaultPattern.decimals;
                    return series;
                });
                dataComputed = dataComputed.map(function (series) { return assignValue(series, defaultPattern); });
                dataComputed = getFilteredSeries(dataComputed);
                dataComputed = dataComputed.map(function (series) {
                    series.row_name = getRowName(series.alias, series.pattern, defaultPattern, row_col_wrapper);
                    series.col_name = getColName(series.alias, series.row_name, series.pattern, defaultPattern, row_col_wrapper);
                    series.key_name = series.row_name + "#" + series.col_name;
                    series.thresholds = getThresholds(series.pattern, defaultPattern, ___getServerTimestamp(series));
                    series.enable_bgColor = series.pattern.enable_bgColor;
                    series.bgColors = (series.pattern.bgColors || defaultPattern.bgColors || "").split("|");
                    series.bgColor = getBgColor(series.pattern, defaultPattern, series.enable_bgColor, series.thresholds, series.bgColors, series.value, series.displayValue);
                    series.enable_bgColor_overrides = series.pattern.enable_bgColor_overrides;
                    series.bgColors_overrides = series.pattern.bgColors_overrides || "";
                    if (series.enable_bgColor_overrides && series.bgColors_overrides !== "") {
                        series.bgColor = getOverridedBGColor(series.bgColors_overrides, series.value, series.bgColor);
                    }
                    series.enable_TextColors = series.pattern.enable_TextColors;
                    series.textColors = (series.pattern.textColors || defaultPattern.textColors || "").split("|");
                    series.textColor = getTextColor(series.pattern, defaultPattern, series.enable_TextColors, series.thresholds, series.textColors, series.value, series.displayValue);
                    series.enable_TextColor_overrides = series.pattern.enable_TextColor_overrides;
                    series.textColors_overrides = series.pattern.textColors_overrides || "";
                    if (series.enable_TextColor_overrides && series.textColors_overrides !== "") {
                        series.textColor = getOverridedTextColor(series.textColors_overrides, series.value, series.textColor);
                    }
                    series.enable_transform = series.pattern.enable_transform;
                    series.transform_values = (series.pattern.transform_values || defaultPattern.transform_values).split("|");
                    series.displayValue = series.enable_transform === true ? ___transformValue(series.thresholds, series.transform_values, series.value, series.displayValue, series.row_name, series.col_name) : series.displayValue;
                    if (series.displayValue === (series.pattern.null_value || defaultPattern.null_value || "Null")) {
                        series.displayValue = series.pattern.null_value || defaultPattern.null_value;
                    }
                    else if (isNaN(series.value)) {
                        series.displayValue = series.pattern.null_value || defaultPattern.null_value;
                    }
                    series.enable_transform_overrides = series.pattern.enable_transform_overrides;
                    series.transform_values_overrides = series.pattern.transform_values_overrides || "";
                    if (series.enable_transform_overrides && series.transform_values_overrides !== "") {
                        series.displayValue = getDisplayValueOverride(series.transform_values_overrides, series.value, series.row_name, series.col_name, series.displayValue);
                    }
                    series.tooltipTemplate = series.pattern.tooltipTemplate || defaultPattern.tooltipTemplate || "Row Name : _row_name_ <br/>Col Name : _col_name_ <br/>Value : _value_";
                    return series;
                });
                dataComputed = dataComputed.map(function (series) { return applyFontAwesomeIcons(series); });
                dataComputed = dataComputed.map(function (series) { return applyImageTransform(series); });
                dataComputed = dataComputed.map(function (series) { return assignClickableLinks(series); });
                return dataComputed;
            };
            exports_1("compute", compute);
        }
    };
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VyaWVzSGFuZGxlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hcHAvc2VyaWVzSGFuZGxlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztZQVFJLGlCQUFpQixHQUFHLFVBQVUsVUFBb0IsRUFBRSxnQkFBMEIsRUFBRSxLQUFhLEVBQUUsWUFBb0IsRUFBRSxRQUFnQixFQUFFLFFBQWdCO2dCQUN2SixJQUFJLENBQUMsR0FBRyxLQUFLLENBQUM7Z0JBQ2QsSUFBSSxVQUFVLElBQUksZ0JBQWdCLElBQUksT0FBTyxLQUFLLEtBQUssUUFBUSxJQUFJLFVBQVUsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxJQUFJLGdCQUFnQixDQUFDLE1BQU0sRUFBRTtvQkFDakgsZ0JBQWdCLEdBQUcsZ0JBQUMsQ0FBQyxTQUFTLENBQUMsZ0JBQWdCLEVBQUUsZ0JBQWdCLENBQUMsTUFBTSxHQUFHLFVBQVUsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUM7b0JBQ2xHLElBQUksZ0JBQWdCLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRTt3QkFDdEQsZ0JBQWdCLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxHQUFHLFNBQVMsQ0FBQztxQkFDN0Q7b0JBQ0QsS0FBSyxJQUFJLENBQUMsR0FBRyxVQUFVLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7d0JBQ3hDLElBQUksS0FBSyxJQUFJLFVBQVUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUU7NEJBQzVCLElBQUksR0FBQyxHQUFHLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxDQUFDOzRCQUM1QixHQUFDLEdBQUcsR0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLE1BQU0sQ0FBQyxTQUFTLEVBQUUsR0FBRyxDQUFDLEVBQUUsTUFBTSxDQUFDLFlBQVks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QixLQUFLLEVBQUUsRUFBRTt3QkFDL0UsTUFBTSxDQUFDLFlBQVksR0FBRyx1QkFBdUIsQ0FBQyxNQUFNLENBQUMsMEJBQTBCLEVBQUUsTUFBTSxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsUUFBUSxFQUFFLE1BQU0sQ0FBQyxRQUFRLEVBQUUsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDO3FCQUN6SjtvQkFDRCxNQUFNLENBQUMsZUFBZSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsZUFBZSxJQUFJLGNBQWMsQ0FBQyxlQUFlLElBQUksdUVBQXVFLENBQUM7b0JBQ3JLLE9BQU8sTUFBTSxDQUFDO2dCQUNsQixDQUFDLENBQUMsQ0FBQztnQkFDSCxZQUFZLEdBQUcsWUFBWSxDQUFDLEdBQUcsQ0FBQyxVQUFBLE1BQU0sSUFBSSxPQUFBLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxFQUE3QixDQUE2QixDQUFDLENBQUM7Z0JBQ3pFLFlBQVksR0FBRyxZQUFZLENBQUMsR0FBRyxDQUFDLFVBQUEsTUFBTSxJQUFJLE9BQUEsbUJBQW1CLENBQUMsTUFBTSxDQUFDLEVBQTNCLENBQTJCLENBQUMsQ0FBQztnQkFDdkUsWUFBWSxHQUFHLFlBQVksQ0FBQyxHQUFHLENBQUMsVUFBQSxNQUFNLElBQUksT0FBQSxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsRUFBNUIsQ0FBNEIsQ0FBQyxDQUFDO2dCQUN4RSxPQUFPLFlBQVksQ0FBQztZQUN4QixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLy88cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi9ub2RlX21vZHVsZXMvZ3JhZmFuYS1zZGstbW9ja3MvYXBwL2hlYWRlcnMvY29tbW9uLmQudHNcIiAvPlxyXG5cclxuaW1wb3J0IF8gZnJvbSBcImxvZGFzaFwiO1xyXG5pbXBvcnQga2JuIGZyb20gXCJhcHAvY29yZS91dGlscy9rYm5cIjtcclxuaW1wb3J0IFRpbWVTZXJpZXMgZnJvbSBcImFwcC9jb3JlL3RpbWVfc2VyaWVzMlwiO1xyXG5pbXBvcnQgKiBhcyB1dGlscyBmcm9tIFwiLi91dGlsc1wiO1xyXG5pbXBvcnQgeyBTZXJpZXMsIFBhdHRlcm4gfSBmcm9tIFwiLi8uLi9pbnRlcmZhY2VzL2ludGVyZmFjZXNcIjtcclxuXHJcbmxldCBfX190cmFuc2Zvcm1WYWx1ZSA9IGZ1bmN0aW9uICh0aHJlc2hvbGRzOiBOdW1iZXJbXSwgdHJhbnNmb3JtX3ZhbHVlczogU3RyaW5nW10sIHZhbHVlOiBOdW1iZXIsIGRpc3BsYXlWYWx1ZTogU3RyaW5nLCByb3dfbmFtZTogU3RyaW5nLCBjb2xfbmFtZTogU3RyaW5nKTogU3RyaW5nIHtcclxuICAgIGxldCB0ID0gdmFsdWU7XHJcbiAgICBpZiAodGhyZXNob2xkcyAmJiB0cmFuc2Zvcm1fdmFsdWVzICYmIHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIiAmJiB0aHJlc2hvbGRzLmxlbmd0aCArIDEgPD0gdHJhbnNmb3JtX3ZhbHVlcy5sZW5ndGgpIHtcclxuICAgICAgICB0cmFuc2Zvcm1fdmFsdWVzID0gXy5kcm9wUmlnaHQodHJhbnNmb3JtX3ZhbHVlcywgdHJhbnNmb3JtX3ZhbHVlcy5sZW5ndGggLSB0aHJlc2hvbGRzLmxlbmd0aCAtIDEpO1xyXG4gICAgICAgIGlmICh0cmFuc2Zvcm1fdmFsdWVzW3RyYW5zZm9ybV92YWx1ZXMubGVuZ3RoIC0gMV0gPT09IFwiXCIpIHtcclxuICAgICAgICAgICAgdHJhbnNmb3JtX3ZhbHVlc1t0cmFuc2Zvcm1fdmFsdWVzLmxlbmd0aCAtIDFdID0gXCJfdmFsdWVfXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAobGV0IGkgPSB0aHJlc2hvbGRzLmxlbmd0aDsgaSA+IDA7IGktLSkge1xyXG4gICAgICAgICAgICBpZiAodmFsdWUgPj0gdGhyZXNob2xkc1tpIC0gMV0pIHtcclxuICAgICAgICAgICAgICAgIGxldCBvID0gdHJhbnNmb3JtX3ZhbHVlc1tpXTtcclxuICAgICAgICAgICAgICAgIG8gPSBvLnJlcGxhY2UobmV3IFJlZ0V4cChcIl92YWx1ZV9cIiwgXCJnXCIpLCBTdHJpbmcoZGlzcGxheVZhbHVlKSk7XHJcbiAgICAgICAgICAgICAgICBvID0gby5yZXBsYWNlKG5ldyBSZWdFeHAoXCJfcm93X25hbWVfXCIsIFwiZ1wiKSwgU3RyaW5nKHJvd19uYW1lKSk7XHJcbiAgICAgICAgICAgICAgICBvID0gby5yZXBsYWNlKG5ldyBSZWdFeHAoXCJfY29sX25hbWVfXCIsIFwiZ1wiKSwgU3RyaW5nKGNvbF9uYW1lKSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgbyA9IF8uZmlyc3QodHJhbnNmb3JtX3ZhbHVlcykgfHwgXCJcIjtcclxuICAgICAgICBvID0gby5yZXBsYWNlKG5ldyBSZWdFeHAoXCJfdmFsdWVfXCIsIFwiZ1wiKSwgU3RyaW5nKGRpc3BsYXlWYWx1ZSkpO1xyXG4gICAgICAgIG8gPSBvLnJlcGxhY2UobmV3IFJlZ0V4cChcIl9yb3dfbmFtZV9cIiwgXCJnXCIpLCBTdHJpbmcocm93X25hbWUpKTtcclxuICAgICAgICBvID0gby5yZXBsYWNlKG5ldyBSZWdFeHAoXCJfY29sX25hbWVfXCIsIFwiZ1wiKSwgU3RyaW5nKGNvbF9uYW1lKSk7XHJcbiAgICAgICAgcmV0dXJuIG87XHJcbiAgICB9XHJcbiAgICByZXR1cm4gU3RyaW5nKHQpO1xyXG59O1xyXG5sZXQgX19fY29tcHV0ZUNvbG9yRnJvbVRocmVzaG9sZHMgPSBmdW5jdGlvbiAodGhyZXNob2xkczogTnVtYmVyW10sIGJnQ29sb3JzOiBTdHJpbmdbXSwgdmFsdWU6IE51bWJlciwgZGVmYXVsdENvbG9yOiBTdHJpbmcpOiBTdHJpbmcge1xyXG4gICAgbGV0IGMgPSBkZWZhdWx0Q29sb3I7XHJcbiAgICBpZiAodGhyZXNob2xkcyAmJiBiZ0NvbG9ycyAmJiB0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIgJiYgdGhyZXNob2xkcy5sZW5ndGggKyAxIDw9IGJnQ29sb3JzLmxlbmd0aCkge1xyXG4gICAgICAgIGJnQ29sb3JzID0gXy5kcm9wUmlnaHQoYmdDb2xvcnMsIGJnQ29sb3JzLmxlbmd0aCAtIHRocmVzaG9sZHMubGVuZ3RoIC0gMSk7XHJcbiAgICAgICAgaWYgKGJnQ29sb3JzW2JnQ29sb3JzLmxlbmd0aCAtIDFdID09PSBcIlwiKSB7XHJcbiAgICAgICAgICAgIGJnQ29sb3JzW2JnQ29sb3JzLmxlbmd0aCAtIDFdID0gZGVmYXVsdENvbG9yO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGxldCBpID0gdGhyZXNob2xkcy5sZW5ndGg7IGkgPiAwOyBpLS0pIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlID49IHRocmVzaG9sZHNbaSAtIDFdKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdXRpbHMubm9ybWFsaXplQ29sb3IoYmdDb2xvcnNbaV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB1dGlscy5ub3JtYWxpemVDb2xvcihfLmZpcnN0KGJnQ29sb3JzKSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYztcclxufTtcclxubGV0IF9fX2dldFNlcnZlclRpbWVzdGFtcCA9IGZ1bmN0aW9uIChzZXJpZXM6IFNlcmllcyk6IERhdGUge1xyXG4gICAgbGV0IGN1cnJlbnRfc2VydmVydGltZXN0YW1wID0gbmV3IERhdGUoKTtcclxuICAgIGlmIChzZXJpZXMgJiYgc2VyaWVzLmRhdGFwb2ludHMgJiYgc2VyaWVzLmRhdGFwb2ludHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGlmIChfLmxhc3Qoc2VyaWVzLmRhdGFwb2ludHMpLmxlbmd0aCA9PT0gMikge1xyXG4gICAgICAgICAgICBjdXJyZW50X3NlcnZlcnRpbWVzdGFtcCA9IG5ldyBEYXRlKF8ubGFzdChzZXJpZXMuZGF0YXBvaW50cylbMV0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBjdXJyZW50X3NlcnZlcnRpbWVzdGFtcDtcclxufTtcclxubGV0IGRlZmF1bHRIYW5kbGVyID0gZnVuY3Rpb24gKHNlcmllc0RhdGE6IFNlcmllcyk6IFNlcmllcyB7XHJcbiAgICBsZXQgc2VyaWVzOiBTZXJpZXMgPSBuZXcgVGltZVNlcmllcyh7XHJcbiAgICAgICAgZGF0YXBvaW50czogc2VyaWVzRGF0YS5kYXRhcG9pbnRzIHx8IFtdLFxyXG4gICAgICAgIGFsaWFzOiBzZXJpZXNEYXRhLnRhcmdldFxyXG4gICAgfSk7XHJcbiAgICBzZXJpZXMuZmxvdHBhaXJzID0gc2VyaWVzLmdldEZsb3RQYWlycyhcImNvbm5lY3RlZFwiKTtcclxuICAgIHJldHVybiBzZXJpZXM7XHJcbn07XHJcbmxldCBnZXRQYXR0ZXJuID0gZnVuY3Rpb24gKHBhdHRlcm5zOiBQYXR0ZXJuW10sIGRlZmF1bHRQYXR0ZXJuOiBQYXR0ZXJuLCBhbGlhczogU3RyaW5nKSB7XHJcbiAgICBsZXQgYWN0aXZlUGF0dGVybnMgPSBwYXR0ZXJucy5maWx0ZXIocCA9PiB7IHJldHVybiBwLmRpc2FibGVkICE9PSB0cnVlOyB9KTtcclxuICAgIGxldCBtYXRjaGluZ1BhdHRlcm4gPSBfLmZpbmQoYWN0aXZlUGF0dGVybnMsIGZ1bmN0aW9uIChwKSB7XHJcbiAgICAgICAgcmV0dXJuIGFsaWFzLm1hdGNoKHAucGF0dGVybik7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBtYXRjaGluZ1BhdHRlcm4gfHwgZGVmYXVsdFBhdHRlcm47XHJcbn07XHJcbmxldCBnZXRSb3dOYW1lID0gZnVuY3Rpb24gKGFsaWFzOiBTdHJpbmcsIHBhdHRlcm46IFBhdHRlcm4sIGRlZmF1bHRQYXR0ZXJuOiBQYXR0ZXJuLCByb3dfY29sX3dyYXBwZXI6IFN0cmluZyk6IFN0cmluZyB7XHJcbiAgICBsZXQgcm93X25hbWU6IFN0cmluZyA9IGFsaWFzLnNwbGl0KFN0cmluZyhwYXR0ZXJuLmRlbGltaXRlcikgfHwgXCIuXCIpLnJlZHVjZSgociwgaXQsIGkpID0+IHtcclxuICAgICAgICByZXR1cm4gci5yZXBsYWNlKG5ldyBSZWdFeHAoU3RyaW5nKHJvd19jb2xfd3JhcHBlcikgKyBpICsgU3RyaW5nKHJvd19jb2xfd3JhcHBlciksIFwiZ1wiKSwgaXQpO1xyXG4gICAgfSwgcGF0dGVybi5yb3dfbmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAocm93X2NvbF93cmFwcGVyICsgXCJzZXJpZXNcIiArIHJvd19jb2xfd3JhcHBlciwgXCJnXCIpLCBTdHJpbmcoYWxpYXMpKSB8fCBkZWZhdWx0UGF0dGVybi5yb3dfbmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAocm93X2NvbF93cmFwcGVyICsgXCJzZXJpZXNcIiArIHJvd19jb2xfd3JhcHBlciwgXCJnXCIpLCBTdHJpbmcoYWxpYXMpKSk7XHJcbiAgICBpZiAoYWxpYXMuc3BsaXQoU3RyaW5nKHBhdHRlcm4uZGVsaW1pdGVyKSB8fCBcIi5cIikubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgcm93X25hbWUgPSBTdHJpbmcoYWxpYXMpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJvd19uYW1lO1xyXG59O1xyXG5sZXQgZ2V0Q29sTmFtZSA9IGZ1bmN0aW9uIChhbGlhczogU3RyaW5nLCByb3dfbmFtZTogU3RyaW5nLCBwYXR0ZXJuOiBQYXR0ZXJuLCBkZWZhdWx0UGF0dGVybjogUGF0dGVybiwgcm93X2NvbF93cmFwcGVyOiBTdHJpbmcpOiBTdHJpbmcge1xyXG4gICAgbGV0IGNvbF9uYW1lID0gYWxpYXMuc3BsaXQoU3RyaW5nKHBhdHRlcm4uZGVsaW1pdGVyKSB8fCBcIi5cIikucmVkdWNlKChyLCBpdCwgaSkgPT4ge1xyXG4gICAgICAgIHJldHVybiByLnJlcGxhY2UobmV3IFJlZ0V4cChTdHJpbmcocm93X2NvbF93cmFwcGVyKSArIGkgKyBTdHJpbmcocm93X2NvbF93cmFwcGVyKSwgXCJnXCIpLCBpdCk7XHJcbiAgICB9LCBwYXR0ZXJuLmNvbF9uYW1lIHx8IGRlZmF1bHRQYXR0ZXJuLmNvbF9uYW1lKTtcclxuICAgIGlmIChhbGlhcy5zcGxpdChTdHJpbmcocGF0dGVybi5kZWxpbWl0ZXIpIHx8IFwiLlwiKS5sZW5ndGggPT09IDEgfHwgcm93X25hbWUgPT09IGFsaWFzKSB7XHJcbiAgICAgICAgY29sX25hbWUgPSBwYXR0ZXJuLmNvbF9uYW1lIHx8IFwiVmFsdWVcIjtcclxuICAgIH1cclxuICAgIHJldHVybiBjb2xfbmFtZTtcclxufTtcclxubGV0IGdldFRocmVzaG9sZHMgPSBmdW5jdGlvbiAocGF0dGVybjogUGF0dGVybiwgZGVmYXVsdFBhdHRlcm46IFBhdHRlcm4sIGN1cnJlbnRfc2VydmVydGltZXN0YW1wOiBEYXRlKTogTnVtYmVyW10ge1xyXG4gICAgbGV0IHRocmVzaG9sZHM6IE51bWJlcltdID0gKHBhdHRlcm4udGhyZXNob2xkcyB8fCBkZWZhdWx0UGF0dGVybi50aHJlc2hvbGRzKS5zcGxpdChcIixcIikubWFwKGQgPT4gK2QpO1xyXG4gICAgaWYgKHBhdHRlcm4uZW5hYmxlX3RpbWVfYmFzZWRfdGhyZXNob2xkcykge1xyXG4gICAgICAgIGxldCBtZXRyaWNyZWNpdmVkVGltZVN0YW1wID0gY3VycmVudF9zZXJ2ZXJ0aW1lc3RhbXAgfHwgbmV3IERhdGUoKTtcclxuICAgICAgICBsZXQgbWV0cmljcmVjaXZlZFRpbWVTdGFtcF9pbm51bWJlciA9IG1ldHJpY3JlY2l2ZWRUaW1lU3RhbXAuZ2V0SG91cnMoKSAqIDEwMCArIG1ldHJpY3JlY2l2ZWRUaW1lU3RhbXAuZ2V0TWludXRlcygpO1xyXG4gICAgICAgIGxldCB3ZWVrZGF5cyA9IFtcInN1blwiLCBcIm1vblwiLCBcInR1ZVwiLCBcIndlZFwiLCBcInRodVwiLCBcImZyaVwiLCBcInNhdFwiXTtcclxuICAgICAgICBfLmVhY2gocGF0dGVybi50aW1lX2Jhc2VkX3RocmVzaG9sZHMsICh0YnR4KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0YnR4ICYmIHRidHguZnJvbSAmJiB0YnR4LnRvICYmIHRidHguZW5hYmxlZERheXMgJiZcclxuICAgICAgICAgICAgICAgIChtZXRyaWNyZWNpdmVkVGltZVN0YW1wX2lubnVtYmVyID49ICsodGJ0eC5mcm9tKSkgJiZcclxuICAgICAgICAgICAgICAgIChtZXRyaWNyZWNpdmVkVGltZVN0YW1wX2lubnVtYmVyIDw9ICsodGJ0eC50bykpICYmXHJcbiAgICAgICAgICAgICAgICAodGJ0eC5lbmFibGVkRGF5cy50b0xvd2VyQ2FzZSgpLmluZGV4T2Yod2Vla2RheXNbbWV0cmljcmVjaXZlZFRpbWVTdGFtcC5nZXREYXkoKV0pID4gLTEpICYmXHJcbiAgICAgICAgICAgICAgICB0YnR4LnRocmVzaG9sZFxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHRocmVzaG9sZHMgPSAodGJ0eC50aHJlc2hvbGQgKyBcIlwiKS5zcGxpdChcIixcIikubWFwKGQgPT4gK2QpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhyZXNob2xkcztcclxufTtcclxubGV0IGFzc2lnblZhbHVlID0gZnVuY3Rpb24gKHNlcmllczogU2VyaWVzLCBkZWZhdWx0UGF0dGVybjogUGF0dGVybik6IFNlcmllcyB7XHJcbiAgICBpZiAoc2VyaWVzLnN0YXRzKSB7XHJcbiAgICAgICAgc2VyaWVzLnZhbHVlID0gc2VyaWVzLnN0YXRzW1N0cmluZyhzZXJpZXMucGF0dGVybi52YWx1ZU5hbWUpIHx8IFN0cmluZyhkZWZhdWx0UGF0dGVybi52YWx1ZU5hbWUpXTtcclxuICAgICAgICBsZXQgZGVjaW1hbEluZm86IGFueSA9IHV0aWxzLmdldERlY2ltYWxzRm9yVmFsdWUoc2VyaWVzLnZhbHVlLCArKHNlcmllcy5kZWNpbWFscykpO1xyXG4gICAgICAgIGxldCBmb3JtYXRGdW5jID0ga2JuLnZhbHVlRm9ybWF0c1tTdHJpbmcoc2VyaWVzLnBhdHRlcm4uZm9ybWF0KSB8fCBTdHJpbmcoZGVmYXVsdFBhdHRlcm4uZm9ybWF0KV07XHJcbiAgICAgICAgaWYgKHNlcmllcy52YWx1ZSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICBzZXJpZXMuZGlzcGxheVZhbHVlID0gc2VyaWVzLnBhdHRlcm4ubnVsbF92YWx1ZSB8fCBkZWZhdWx0UGF0dGVybi5udWxsX3ZhbHVlIHx8IFwiTnVsbFwiO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoIWlzTmFOKHNlcmllcy52YWx1ZSkpIHtcclxuICAgICAgICAgICAgc2VyaWVzLnZhbHVlRm9ybWF0dGVkID0gZm9ybWF0RnVuYyhzZXJpZXMudmFsdWUsIGRlY2ltYWxJbmZvLmRlY2ltYWxzLCBkZWNpbWFsSW5mby5zY2FsZWREZWNpbWFscyk7XHJcbiAgICAgICAgICAgIHNlcmllcy52YWx1ZVJvdW5kZWQgPSBrYm4ucm91bmRWYWx1ZShzZXJpZXMudmFsdWUsIGRlY2ltYWxJbmZvLmRlY2ltYWxzKTtcclxuICAgICAgICAgICAgc2VyaWVzLmRpc3BsYXlWYWx1ZSA9IHNlcmllcy52YWx1ZUZvcm1hdHRlZDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzZXJpZXMuZGlzcGxheVZhbHVlID0gc2VyaWVzLnBhdHRlcm4ubnVsbF92YWx1ZSB8fCBkZWZhdWx0UGF0dGVybi5udWxsX3ZhbHVlIHx8IFwiTnVsbFwiO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBzZXJpZXM7XHJcbn07XHJcbmxldCBmaWx0ZXJWYWx1ZXMgPSBmdW5jdGlvbiAoc2VyaWVzOiBTZXJpZXMpOiBCb29sZWFuIHtcclxuICAgIGlmICghc2VyaWVzLnBhdHRlcm4uZmlsdGVyKSB7XHJcbiAgICAgICAgc2VyaWVzLnBhdHRlcm4uZmlsdGVyID0ge1xyXG4gICAgICAgICAgICB2YWx1ZV9iZWxvdzogXCJcIixcclxuICAgICAgICAgICAgdmFsdWVfYWJvdmU6IFwiXCJcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgaWYgKHNlcmllcy5wYXR0ZXJuICYmIHNlcmllcy5wYXR0ZXJuLmZpbHRlciAmJiAoc2VyaWVzLnBhdHRlcm4uZmlsdGVyLnZhbHVlX2JlbG93ICE9PSBcIlwiIHx8IHNlcmllcy5wYXR0ZXJuLmZpbHRlci52YWx1ZV9hYm92ZSAhPT0gXCJcIikpIHtcclxuICAgICAgICBpZiAoc2VyaWVzLnBhdHRlcm4uZmlsdGVyLnZhbHVlX2JlbG93ICE9PSBcIlwiICYmIHNlcmllcy52YWx1ZSA8ICsoc2VyaWVzLnBhdHRlcm4uZmlsdGVyLnZhbHVlX2JlbG93KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzZXJpZXMucGF0dGVybi5maWx0ZXIudmFsdWVfYWJvdmUgIT09IFwiXCIgJiYgc2VyaWVzLnZhbHVlID4gKyhzZXJpZXMucGF0dGVybi5maWx0ZXIudmFsdWVfYWJvdmUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG59O1xyXG5sZXQgZ2V0RmlsdGVyZWRTZXJpZXMgPSBmdW5jdGlvbiAoc2VyaWVzQXJyYXk6IFNlcmllc1tdKTogU2VyaWVzW10ge1xyXG4gICAgbGV0IG5ld1NlcmllczogU2VyaWVzW10gPSBbXTtcclxuICAgIF8uZWFjaChzZXJpZXNBcnJheSwgc2VyaWVzID0+IHtcclxuICAgICAgICBpZiAoZmlsdGVyVmFsdWVzKHNlcmllcykpIHtcclxuICAgICAgICAgICAgbmV3U2VyaWVzLnB1c2goc2VyaWVzKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBuZXdTZXJpZXM7XHJcbn07XHJcbmxldCBnZXREaXNwbGF5VmFsdWVPdmVycmlkZSA9IGZ1bmN0aW9uICh0cmFuc2Zvcm1fdmFsdWVzX292ZXJyaWRlczogU3RyaW5nLCB2YWx1ZTogTnVtYmVyLCByb3dfbmFtZTogU3RyaW5nLCBjb2xfbmFtZTogU3RyaW5nLCBkaXNwbGF5VmFsdWU6IFN0cmluZyk6IFN0cmluZyB7XHJcbiAgICBsZXQgX3RyYW5zZm9ybV92YWx1ZXNfb3ZlcnJpZGVzID0gdHJhbnNmb3JtX3ZhbHVlc19vdmVycmlkZXMuc3BsaXQoXCJ8XCIpLmZpbHRlcihjb24gPT4gY29uLmluZGV4T2YoXCItPlwiKSA+IC0xKS5tYXAoY29uID0+IGNvbi5zcGxpdChcIi0+XCIpKS5maWx0ZXIoY29uID0+ICsoY29uWzBdKSA9PT0gdmFsdWUpLm1hcChjb24gPT4gY29uWzFdKTtcclxuICAgIGlmIChfdHJhbnNmb3JtX3ZhbHVlc19vdmVycmlkZXMubGVuZ3RoID4gMCAmJiBfdHJhbnNmb3JtX3ZhbHVlc19vdmVycmlkZXNbMF0gIT09IFwiXCIpIHtcclxuICAgICAgICBkaXNwbGF5VmFsdWUgPSAoXCJcIiArIF90cmFuc2Zvcm1fdmFsdWVzX292ZXJyaWRlc1swXSkudHJpbSgpLnJlcGxhY2UobmV3IFJlZ0V4cChcIl92YWx1ZV9cIiwgXCJnXCIpLCBTdHJpbmcoZGlzcGxheVZhbHVlKSkucmVwbGFjZShuZXcgUmVnRXhwKFwiX3Jvd19uYW1lX1wiLCBcImdcIiksIFN0cmluZyhyb3dfbmFtZSkpLnJlcGxhY2UobmV3IFJlZ0V4cChcIl9jb2xfbmFtZV9cIiwgXCJnXCIpLCBTdHJpbmcoY29sX25hbWUpKTtcclxuICAgIH1cclxuICAgIHJldHVybiBkaXNwbGF5VmFsdWU7XHJcbn07XHJcbmxldCBnZXRCZ0NvbG9yID0gZnVuY3Rpb24gKHBhdHRlcm46IFBhdHRlcm4sIGRlZmF1bHRQYXR0ZXJuOiBQYXR0ZXJuLCBlbmFibGVfYmdDb2xvcjogQm9vbGVhbiwgdGhyZXNob2xkczogTnVtYmVyW10sIGJnQ29sb3JzOiBTdHJpbmdbXSwgdmFsdWU6IE51bWJlciwgZGlzcGxheVZhbHVlOiBhbnkpOiBTdHJpbmcge1xyXG4gICAgbGV0IGJnQ29sb3IgPSBlbmFibGVfYmdDb2xvciA9PT0gdHJ1ZSA/IF9fX2NvbXB1dGVDb2xvckZyb21UaHJlc2hvbGRzKHRocmVzaG9sZHMsIGJnQ29sb3JzLCB2YWx1ZSwgXCJ0cmFuc3BhcmVudFwiKSA6IFwidHJhbnNwYXJlbnRcIjtcclxuICAgIGlmIChkaXNwbGF5VmFsdWUgPT09IChwYXR0ZXJuLm51bGxfdmFsdWUgfHwgZGVmYXVsdFBhdHRlcm4ubnVsbF92YWx1ZSB8fCBcIk51bGxcIikpIHtcclxuICAgICAgICBiZ0NvbG9yID0gcGF0dGVybi5udWxsX2NvbG9yIHx8IGRlZmF1bHRQYXR0ZXJuLm51bGxfY29sb3IgfHwgXCJ0cmFuc3BhcmVudFwiO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGJnQ29sb3I7XHJcbn07XHJcbmxldCBnZXRPdmVycmlkZWRCR0NvbG9yID0gZnVuY3Rpb24gKGJnQ29sb3JzX292ZXJyaWRlczogU3RyaW5nLCB2YWx1ZTogTnVtYmVyLCBkZWZhdWx0QkdDb2xvcjogU3RyaW5nKTogU3RyaW5nIHtcclxuICAgIGxldCBiZ0NvbG9yID0gZGVmYXVsdEJHQ29sb3I7XHJcbiAgICBsZXQgX2JnQ29sb3JzX292ZXJyaWRlcyA9IGJnQ29sb3JzX292ZXJyaWRlcy5zcGxpdChcInxcIikuZmlsdGVyKGNvbiA9PiBjb24uaW5kZXhPZihcIi0+XCIpID4gLTEpLm1hcChjb24gPT4gY29uLnNwbGl0KFwiLT5cIikpLmZpbHRlcihjb24gPT4gKyhjb25bMF0pID09PSB2YWx1ZSkubWFwKGNvbiA9PiBjb25bMV0pO1xyXG4gICAgaWYgKF9iZ0NvbG9yc19vdmVycmlkZXMubGVuZ3RoID4gMCAmJiBfYmdDb2xvcnNfb3ZlcnJpZGVzWzBdICE9PSBcIlwiKSB7XHJcbiAgICAgICAgYmdDb2xvciA9IHV0aWxzLm5vcm1hbGl6ZUNvbG9yKChcIlwiICsgX2JnQ29sb3JzX292ZXJyaWRlc1swXSkudHJpbSgpKTtcclxuICAgIH1cclxuICAgIHJldHVybiBiZ0NvbG9yO1xyXG59O1xyXG5sZXQgZ2V0VGV4dENvbG9yID0gZnVuY3Rpb24gKHBhdHRlcm46IFBhdHRlcm4sIGRlZmF1bHRQYXR0ZXJuOiBQYXR0ZXJuLCBlbmFibGVfVGV4dENvbG9yczogQm9vbGVhbiwgdGhyZXNob2xkczogTnVtYmVyW10sIHRleHRDb2xvcnM6IFN0cmluZ1tdLCB2YWx1ZTogTnVtYmVyLCBkaXNwbGF5VmFsdWU6IGFueSk6IFN0cmluZyB7XHJcbiAgICBsZXQgdGV4dENvbG9yID0gZW5hYmxlX1RleHRDb2xvcnMgPT09IHRydWUgPyBfX19jb21wdXRlQ29sb3JGcm9tVGhyZXNob2xkcyh0aHJlc2hvbGRzLCB0ZXh0Q29sb3JzLCB2YWx1ZSwgXCJ3aGl0ZVwiKSA6IFwid2hpdGVcIjtcclxuICAgIGlmIChkaXNwbGF5VmFsdWUgPT09IChwYXR0ZXJuLm51bGxfdmFsdWUgfHwgZGVmYXVsdFBhdHRlcm4ubnVsbF92YWx1ZSB8fCBcIk51bGxcIikpIHtcclxuICAgICAgICB0ZXh0Q29sb3IgPSBwYXR0ZXJuLm51bGxfdGV4dF9jb2xvciB8fCBkZWZhdWx0UGF0dGVybi5udWxsX3RleHRfY29sb3IgfHwgXCJ3aGl0ZVwiO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRleHRDb2xvcjtcclxufTtcclxubGV0IGdldE92ZXJyaWRlZFRleHRDb2xvciA9IGZ1bmN0aW9uICh0ZXh0Q29sb3JzX292ZXJyaWRlczogU3RyaW5nLCB2YWx1ZTogTnVtYmVyLCBkZWZhdWx0dGV4dENvbG9yOiBTdHJpbmcpOiBTdHJpbmcge1xyXG4gICAgbGV0IHRleHRDb2xvciA9IGRlZmF1bHR0ZXh0Q29sb3I7XHJcbiAgICBsZXQgX3RleHRDb2xvcnNfb3ZlcnJpZGVzID0gdGV4dENvbG9yc19vdmVycmlkZXMuc3BsaXQoXCJ8XCIpLmZpbHRlcihjb24gPT4gY29uLmluZGV4T2YoXCItPlwiKSA+IC0xKS5tYXAoY29uID0+IGNvbi5zcGxpdChcIi0+XCIpKS5maWx0ZXIoY29uID0+ICsoY29uWzBdKSA9PT0gdmFsdWUpLm1hcChjb24gPT4gY29uWzFdKTtcclxuICAgIGlmIChfdGV4dENvbG9yc19vdmVycmlkZXMubGVuZ3RoID4gMCAmJiBfdGV4dENvbG9yc19vdmVycmlkZXNbMF0gIT09IFwiXCIpIHtcclxuICAgICAgICB0ZXh0Q29sb3IgPSB1dGlscy5ub3JtYWxpemVDb2xvcigoXCJcIiArIF90ZXh0Q29sb3JzX292ZXJyaWRlc1swXSkudHJpbSgpKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0ZXh0Q29sb3I7XHJcbn07XHJcbmxldCBhcHBseUZvbnRBd2Vzb21lSWNvbnMgPSBmdW5jdGlvbiAoc2VyaWVzOiBTZXJpZXMpOiBTZXJpZXMge1xyXG4gICAgc2VyaWVzLmFjdHVhbF9kaXNwbGF5dmFsdWUgPSBzZXJpZXMuZGlzcGxheVZhbHVlO1xyXG4gICAgc2VyaWVzLmFjdHVhbF9yb3dfbmFtZSA9IHNlcmllcy5yb3dfbmFtZTtcclxuICAgIHNlcmllcy5hY3R1YWxfY29sX25hbWUgPSBzZXJpZXMuY29sX25hbWU7XHJcbiAgICBpZiAoc2VyaWVzLmRpc3BsYXlWYWx1ZSAmJiBzZXJpZXMuZGlzcGxheVZhbHVlLmluZGV4T2YoXCJfZmEtXCIpID4gLTEpIHtcclxuICAgICAgICBzZXJpZXMuZGlzcGxheVZhbHVlID0gdXRpbHMucmVwbGFjZUZvbnRBd2Vzb21lSWNvbnMoc2VyaWVzLmRpc3BsYXlWYWx1ZSk7XHJcbiAgICB9XHJcbiAgICBpZiAoc2VyaWVzLnJvd19uYW1lICYmIHNlcmllcy5yb3dfbmFtZS5pbmRleE9mKFwiX2ZhLVwiKSA+IC0xKSB7XHJcbiAgICAgICAgc2VyaWVzLnJvd19uYW1lID0gdXRpbHMucmVwbGFjZUZvbnRBd2Vzb21lSWNvbnMoc2VyaWVzLnJvd19uYW1lKTtcclxuICAgIH1cclxuICAgIGlmIChzZXJpZXMuY29sX25hbWUgJiYgc2VyaWVzLmNvbF9uYW1lLmluZGV4T2YoXCJfZmEtXCIpID4gLTEpIHtcclxuICAgICAgICBzZXJpZXMuY29sX25hbWUgPSB1dGlscy5yZXBsYWNlRm9udEF3ZXNvbWVJY29ucyhzZXJpZXMuY29sX25hbWUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHNlcmllcztcclxufTtcclxubGV0IGFwcGx5SW1hZ2VUcmFuc2Zvcm0gPSBmdW5jdGlvbiAoc2VyaWVzOiBTZXJpZXMpOiBTZXJpZXMge1xyXG4gICAgaWYgKHNlcmllcy5kaXNwbGF5VmFsdWUgJiYgc2VyaWVzLmRpc3BsYXlWYWx1ZS5pbmRleE9mKFwiX2ltZy1cIikgPiAtMSkge1xyXG4gICAgICAgIHNlcmllcy5kaXNwbGF5VmFsdWUgPSB1dGlscy5yZXBsYWNlV2l0aEltYWdlcyhzZXJpZXMuZGlzcGxheVZhbHVlKTtcclxuICAgIH1cclxuICAgIGlmIChzZXJpZXMucm93X25hbWUgJiYgc2VyaWVzLnJvd19uYW1lLmluZGV4T2YoXCJfaW1nLVwiKSA+IC0xKSB7XHJcbiAgICAgICAgc2VyaWVzLnJvd19uYW1lID0gdXRpbHMucmVwbGFjZVdpdGhJbWFnZXMoc2VyaWVzLnJvd19uYW1lKTtcclxuICAgIH1cclxuICAgIGlmIChzZXJpZXMuY29sX25hbWUgJiYgc2VyaWVzLmNvbF9uYW1lLmluZGV4T2YoXCJfaW1nLVwiKSA+IC0xKSB7XHJcbiAgICAgICAgc2VyaWVzLmNvbF9uYW1lID0gdXRpbHMucmVwbGFjZVdpdGhJbWFnZXMoc2VyaWVzLmNvbF9uYW1lKTtcclxuICAgIH1cclxuICAgIHJldHVybiBzZXJpZXM7XHJcbn07XHJcbmxldCBhc3NpZ25DbGlja2FibGVMaW5rcyA9IGZ1bmN0aW9uIChzZXJpZXM6IFNlcmllcyk6IFNlcmllcyB7XHJcbiAgICBpZiAoc2VyaWVzLnBhdHRlcm4uZW5hYmxlX2NsaWNrYWJsZV9jZWxscykge1xyXG4gICAgICAgIGxldCB0YXJnZXRMaW5rID0gc2VyaWVzLnBhdHRlcm4uY2xpY2thYmxlX2NlbGxzX2xpbmsgfHwgXCIjXCI7XHJcbiAgICAgICAgdGFyZ2V0TGluayA9IHRhcmdldExpbmsucmVwbGFjZShuZXcgUmVnRXhwKFwiX3Jvd19uYW1lX1wiLCBcImdcIiksIHV0aWxzLmdldEFjdHVhbE5hbWVXaXRob3V0VHJhbnNmb3JtU2lnbihzZXJpZXMuYWN0dWFsX3Jvd19uYW1lKS50cmltKCkpO1xyXG4gICAgICAgIHRhcmdldExpbmsgPSB0YXJnZXRMaW5rLnJlcGxhY2UobmV3IFJlZ0V4cChcIl9jb2xfbmFtZV9cIiwgXCJnXCIpLCB1dGlscy5nZXRBY3R1YWxOYW1lV2l0aG91dFRyYW5zZm9ybVNpZ24oc2VyaWVzLmFjdHVhbF9jb2xfbmFtZSkudHJpbSgpKTtcclxuICAgICAgICB0YXJnZXRMaW5rID0gdGFyZ2V0TGluay5yZXBsYWNlKG5ldyBSZWdFeHAoXCJfdmFsdWVfXCIsIFwiZ1wiKSwgdXRpbHMuZ2V0QWN0dWFsTmFtZVdpdGhvdXRUcmFuc2Zvcm1TaWduKHNlcmllcy52YWx1ZSkudHJpbSgpKTtcclxuICAgICAgICBzZXJpZXMuZGlzcGxheVZhbHVlID0gYDxhIGhyZWY9XCIke3RhcmdldExpbmt9XCIgdGFyZ2V0PVwiX2JsYW5rXCI+JHtzZXJpZXMuZGlzcGxheVZhbHVlfTwvYT5gO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHNlcmllcztcclxufTtcclxubGV0IGNvbXB1dGUgPSBmdW5jdGlvbiAoZGF0YUNvbXB1dGVkOiBTZXJpZXNbXSwgZGVmYXVsdFBhdHRlcm46IFBhdHRlcm4sIHBhdHRlcm5zOiBQYXR0ZXJuW10sIHJvd19jb2xfd3JhcHBlcjogU3RyaW5nKTogU2VyaWVzW10ge1xyXG4gICAgZGF0YUNvbXB1dGVkID0gZGF0YUNvbXB1dGVkLm1hcChzZXJpZXMgPT4ge1xyXG4gICAgICAgIHNlcmllcy5wYXR0ZXJuID0gZ2V0UGF0dGVybihwYXR0ZXJucywgZGVmYXVsdFBhdHRlcm4sIHNlcmllcy5hbGlhcyk7XHJcbiAgICAgICAgc2VyaWVzLmRlY2ltYWxzID0gc2VyaWVzLnBhdHRlcm4uZGVjaW1hbHMgfHwgZGVmYXVsdFBhdHRlcm4uZGVjaW1hbHM7XHJcbiAgICAgICAgcmV0dXJuIHNlcmllcztcclxuICAgIH0pO1xyXG4gICAgZGF0YUNvbXB1dGVkID0gZGF0YUNvbXB1dGVkLm1hcChzZXJpZXMgPT4gYXNzaWduVmFsdWUoc2VyaWVzLCBkZWZhdWx0UGF0dGVybikpO1xyXG4gICAgZGF0YUNvbXB1dGVkID0gZ2V0RmlsdGVyZWRTZXJpZXMoZGF0YUNvbXB1dGVkKTtcclxuICAgIGRhdGFDb21wdXRlZCA9IGRhdGFDb21wdXRlZC5tYXAoc2VyaWVzID0+IHtcclxuICAgICAgICBzZXJpZXMucm93X25hbWUgPSBnZXRSb3dOYW1lKHNlcmllcy5hbGlhcywgc2VyaWVzLnBhdHRlcm4sIGRlZmF1bHRQYXR0ZXJuLCByb3dfY29sX3dyYXBwZXIpO1xyXG4gICAgICAgIHNlcmllcy5jb2xfbmFtZSA9IGdldENvbE5hbWUoc2VyaWVzLmFsaWFzLCBzZXJpZXMucm93X25hbWUsIHNlcmllcy5wYXR0ZXJuLCBkZWZhdWx0UGF0dGVybiwgcm93X2NvbF93cmFwcGVyKTtcclxuICAgICAgICBzZXJpZXMua2V5X25hbWUgPSBzZXJpZXMucm93X25hbWUgKyBcIiNcIiArIHNlcmllcy5jb2xfbmFtZTtcclxuICAgICAgICBzZXJpZXMudGhyZXNob2xkcyA9IGdldFRocmVzaG9sZHMoc2VyaWVzLnBhdHRlcm4sIGRlZmF1bHRQYXR0ZXJuLCBfX19nZXRTZXJ2ZXJUaW1lc3RhbXAoc2VyaWVzKSk7XHJcbiAgICAgICAgc2VyaWVzLmVuYWJsZV9iZ0NvbG9yID0gc2VyaWVzLnBhdHRlcm4uZW5hYmxlX2JnQ29sb3I7XHJcbiAgICAgICAgc2VyaWVzLmJnQ29sb3JzID0gKHNlcmllcy5wYXR0ZXJuLmJnQ29sb3JzIHx8IGRlZmF1bHRQYXR0ZXJuLmJnQ29sb3JzIHx8IFwiXCIpLnNwbGl0KFwifFwiKTtcclxuICAgICAgICBzZXJpZXMuYmdDb2xvciA9IGdldEJnQ29sb3Ioc2VyaWVzLnBhdHRlcm4sIGRlZmF1bHRQYXR0ZXJuLCBzZXJpZXMuZW5hYmxlX2JnQ29sb3IsIHNlcmllcy50aHJlc2hvbGRzLCBzZXJpZXMuYmdDb2xvcnMsIHNlcmllcy52YWx1ZSwgc2VyaWVzLmRpc3BsYXlWYWx1ZSk7XHJcbiAgICAgICAgc2VyaWVzLmVuYWJsZV9iZ0NvbG9yX292ZXJyaWRlcyA9IHNlcmllcy5wYXR0ZXJuLmVuYWJsZV9iZ0NvbG9yX292ZXJyaWRlcztcclxuICAgICAgICBzZXJpZXMuYmdDb2xvcnNfb3ZlcnJpZGVzID0gc2VyaWVzLnBhdHRlcm4uYmdDb2xvcnNfb3ZlcnJpZGVzIHx8IFwiXCI7XHJcbiAgICAgICAgaWYgKHNlcmllcy5lbmFibGVfYmdDb2xvcl9vdmVycmlkZXMgJiYgc2VyaWVzLmJnQ29sb3JzX292ZXJyaWRlcyAhPT0gXCJcIikge1xyXG4gICAgICAgICAgICBzZXJpZXMuYmdDb2xvciA9IGdldE92ZXJyaWRlZEJHQ29sb3Ioc2VyaWVzLmJnQ29sb3JzX292ZXJyaWRlcywgc2VyaWVzLnZhbHVlLCBzZXJpZXMuYmdDb2xvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlcmllcy5lbmFibGVfVGV4dENvbG9ycyA9IHNlcmllcy5wYXR0ZXJuLmVuYWJsZV9UZXh0Q29sb3JzO1xyXG4gICAgICAgIHNlcmllcy50ZXh0Q29sb3JzID0gKHNlcmllcy5wYXR0ZXJuLnRleHRDb2xvcnMgfHwgZGVmYXVsdFBhdHRlcm4udGV4dENvbG9ycyB8fCBcIlwiKS5zcGxpdChcInxcIik7XHJcbiAgICAgICAgc2VyaWVzLnRleHRDb2xvciA9IGdldFRleHRDb2xvcihzZXJpZXMucGF0dGVybiwgZGVmYXVsdFBhdHRlcm4sIHNlcmllcy5lbmFibGVfVGV4dENvbG9ycywgc2VyaWVzLnRocmVzaG9sZHMsIHNlcmllcy50ZXh0Q29sb3JzLCBzZXJpZXMudmFsdWUsIHNlcmllcy5kaXNwbGF5VmFsdWUpO1xyXG4gICAgICAgIHNlcmllcy5lbmFibGVfVGV4dENvbG9yX292ZXJyaWRlcyA9IHNlcmllcy5wYXR0ZXJuLmVuYWJsZV9UZXh0Q29sb3Jfb3ZlcnJpZGVzO1xyXG4gICAgICAgIHNlcmllcy50ZXh0Q29sb3JzX292ZXJyaWRlcyA9IHNlcmllcy5wYXR0ZXJuLnRleHRDb2xvcnNfb3ZlcnJpZGVzIHx8IFwiXCI7XHJcbiAgICAgICAgaWYgKHNlcmllcy5lbmFibGVfVGV4dENvbG9yX292ZXJyaWRlcyAmJiBzZXJpZXMudGV4dENvbG9yc19vdmVycmlkZXMgIT09IFwiXCIpIHtcclxuICAgICAgICAgICAgc2VyaWVzLnRleHRDb2xvciA9IGdldE92ZXJyaWRlZFRleHRDb2xvcihzZXJpZXMudGV4dENvbG9yc19vdmVycmlkZXMsIHNlcmllcy52YWx1ZSwgc2VyaWVzLnRleHRDb2xvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlcmllcy5lbmFibGVfdHJhbnNmb3JtID0gc2VyaWVzLnBhdHRlcm4uZW5hYmxlX3RyYW5zZm9ybTtcclxuICAgICAgICBzZXJpZXMudHJhbnNmb3JtX3ZhbHVlcyA9IChzZXJpZXMucGF0dGVybi50cmFuc2Zvcm1fdmFsdWVzIHx8IGRlZmF1bHRQYXR0ZXJuLnRyYW5zZm9ybV92YWx1ZXMpLnNwbGl0KFwifFwiKTtcclxuICAgICAgICBzZXJpZXMuZGlzcGxheVZhbHVlID0gc2VyaWVzLmVuYWJsZV90cmFuc2Zvcm0gPT09IHRydWUgPyBfX190cmFuc2Zvcm1WYWx1ZShzZXJpZXMudGhyZXNob2xkcywgc2VyaWVzLnRyYW5zZm9ybV92YWx1ZXMsIHNlcmllcy52YWx1ZSwgc2VyaWVzLmRpc3BsYXlWYWx1ZSwgc2VyaWVzLnJvd19uYW1lLCBzZXJpZXMuY29sX25hbWUpIDogc2VyaWVzLmRpc3BsYXlWYWx1ZTtcclxuICAgICAgICBpZiAoc2VyaWVzLmRpc3BsYXlWYWx1ZSA9PT0gKHNlcmllcy5wYXR0ZXJuLm51bGxfdmFsdWUgfHwgZGVmYXVsdFBhdHRlcm4ubnVsbF92YWx1ZSB8fCBcIk51bGxcIikpIHtcclxuICAgICAgICAgICAgc2VyaWVzLmRpc3BsYXlWYWx1ZSA9IHNlcmllcy5wYXR0ZXJuLm51bGxfdmFsdWUgfHwgZGVmYXVsdFBhdHRlcm4ubnVsbF92YWx1ZTtcclxuICAgICAgICB9IGVsc2UgaWYgKGlzTmFOKHNlcmllcy52YWx1ZSkpIHtcclxuICAgICAgICAgICAgc2VyaWVzLmRpc3BsYXlWYWx1ZSA9IHNlcmllcy5wYXR0ZXJuLm51bGxfdmFsdWUgfHwgZGVmYXVsdFBhdHRlcm4ubnVsbF92YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2VyaWVzLmVuYWJsZV90cmFuc2Zvcm1fb3ZlcnJpZGVzID0gc2VyaWVzLnBhdHRlcm4uZW5hYmxlX3RyYW5zZm9ybV9vdmVycmlkZXM7XHJcbiAgICAgICAgc2VyaWVzLnRyYW5zZm9ybV92YWx1ZXNfb3ZlcnJpZGVzID0gc2VyaWVzLnBhdHRlcm4udHJhbnNmb3JtX3ZhbHVlc19vdmVycmlkZXMgfHwgXCJcIjtcclxuICAgICAgICBpZiAoc2VyaWVzLmVuYWJsZV90cmFuc2Zvcm1fb3ZlcnJpZGVzICYmIHNlcmllcy50cmFuc2Zvcm1fdmFsdWVzX292ZXJyaWRlcyAhPT0gXCJcIikge1xyXG4gICAgICAgICAgICBzZXJpZXMuZGlzcGxheVZhbHVlID0gZ2V0RGlzcGxheVZhbHVlT3ZlcnJpZGUoc2VyaWVzLnRyYW5zZm9ybV92YWx1ZXNfb3ZlcnJpZGVzLCBzZXJpZXMudmFsdWUsIHNlcmllcy5yb3dfbmFtZSwgc2VyaWVzLmNvbF9uYW1lLCBzZXJpZXMuZGlzcGxheVZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2VyaWVzLnRvb2x0aXBUZW1wbGF0ZSA9IHNlcmllcy5wYXR0ZXJuLnRvb2x0aXBUZW1wbGF0ZSB8fCBkZWZhdWx0UGF0dGVybi50b29sdGlwVGVtcGxhdGUgfHwgXCJSb3cgTmFtZSA6IF9yb3dfbmFtZV8gPGJyLz5Db2wgTmFtZSA6IF9jb2xfbmFtZV8gPGJyLz5WYWx1ZSA6IF92YWx1ZV9cIjtcclxuICAgICAgICByZXR1cm4gc2VyaWVzO1xyXG4gICAgfSk7XHJcbiAgICBkYXRhQ29tcHV0ZWQgPSBkYXRhQ29tcHV0ZWQubWFwKHNlcmllcyA9PiBhcHBseUZvbnRBd2Vzb21lSWNvbnMoc2VyaWVzKSk7XHJcbiAgICBkYXRhQ29tcHV0ZWQgPSBkYXRhQ29tcHV0ZWQubWFwKHNlcmllcyA9PiBhcHBseUltYWdlVHJhbnNmb3JtKHNlcmllcykpO1xyXG4gICAgZGF0YUNvbXB1dGVkID0gZGF0YUNvbXB1dGVkLm1hcChzZXJpZXMgPT4gYXNzaWduQ2xpY2thYmxlTGlua3Moc2VyaWVzKSk7XHJcbiAgICByZXR1cm4gZGF0YUNvbXB1dGVkO1xyXG59O1xyXG5leHBvcnQge1xyXG4gICAgY29tcHV0ZSxcclxuICAgIGRlZmF1bHRIYW5kbGVyXHJcbn07XHJcbiJdfQ==