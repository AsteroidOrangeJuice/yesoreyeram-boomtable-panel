/*! 
Plugin Name : Boom Table
Plugin ID : yesoreyeram-boomtable-panel
Plugin URL : https://github.com/yesoreyeram/yesoreyeram-boomtable-panel
Plugin Author : Sriramajeyam Sugumaran https://www.google.com/search?q=Sriramajeyam+Sugumaran
Plugin Version : v0.6.0
*/
System.register(["lodash","./utils","./config","./seriesHandler","./renderer"],function(exports_1,context_1){"use strict";var lodash_1,utils,config_1,seriesHandler_1,renderer,computeRenderingData,getOptionOverride;context_1&&context_1.id;return{setters:[function(lodash_1_1){lodash_1=lodash_1_1},function(utils_1){utils=utils_1},function(config_1_1){config_1=config_1_1},function(seriesHandler_1_1){seriesHandler_1=seriesHandler_1_1},function(renderer_1){renderer=renderer_1}],execute:function(){computeRenderingData=function(data,patterns,defaultPattern,panelOptions,rendering_options,debug_mode){var returnData={error:void 0,output_html:{header:"",body:"",footer:"",debug:""}};if(data&&data.length>0&&lodash_1["default"].filter(data,function(d){return d.type&&"table"===d.type}).length>0)returnData.error=utils.buildError("Only timeseries data supported","Only timeseries data supported");else if(data){var metricsReceived_1=utils.getFields(data,"target");if(utils.hasDuplicates(metricsReceived_1)){var duplicateKeys=lodash_1["default"].uniq(metricsReceived_1.filter(function(v){return metricsReceived_1.filter(function(t){return t===v}).length>1}));returnData.error=utils.buildError("Duplicate series found","Duplicate series : <br/> "+duplicateKeys.join("<br/> "))}else{returnData.error=void 0;var mydata=data.map(seriesHandler_1.defaultHandler.bind(data)),dataComputed=seriesHandler_1.compute(mydata,defaultPattern,patterns,panelOptions.row_col_wrapper),rows_found=utils.getFields(dataComputed,"row_name"),cols_found=utils.getFields(dataComputed,"col_name"),keys_found_1=utils.getFields(dataComputed,"key_name");if(utils.hasDuplicates(keys_found_1)){var duplicateKeys=lodash_1["default"].uniq(keys_found_1.filter(function(v){return keys_found_1.filter(function(t){return t===v}).length>1}));returnData.error=utils.buildError("Duplicate keys found","Duplicate key values : <br/> "+duplicateKeys.join("<br/> "))}else if(utils.isUniqueArray(keys_found_1)){returnData.error=void 0;var output=renderer.buildOutputData(dataComputed,rows_found,cols_found,defaultPattern,{no_match_text:panelOptions.no_match_text}),_a=renderer.buildOutput(output,cols_found,rendering_options),header=_a.header,body=_a.body,footer=_a.footer;returnData.output_html.header=String(header),returnData.output_html.body=String(body),returnData.output_html.footer=String(footer)}debug_mode&&(returnData.output_html.debug=String(renderer.buildDebugOutput(dataComputed)))}}return returnData},exports_1("computeRenderingData",computeRenderingData),getOptionOverride=function(currentOptionOverrides,propertyName){var option=lodash_1["default"].find(currentOptionOverrides,function(o){return o.propertyName===propertyName}),default_option=lodash_1["default"].find(config_1.config.optionOverrides,function(o){return o.propertyName===propertyName});return option?option.value:default_option.defaultValue},exports_1("getOptionOverride",getOptionOverride)}}});